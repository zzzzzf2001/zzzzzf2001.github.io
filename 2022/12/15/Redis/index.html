<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>redis | MyBlog</title><meta name="author" content="学不动学不懂学步冻"><meta name="copyright" content="学不动学不懂学步冻"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Redis1、NoSQL1、概述NoSQL（not  only SQL ） 不仅仅是SQL，泛指非关系型数据库，NoSQL不依赖业务逻辑方式存储，而是以简单的key-Value 模式  存储，因此的 大大的增加了数据库的拓展能力  不遵守SQL标准 不支持ACID（原子性，一致性，隔离性，持久性） 远超于SQL的性能  2、NoSQL 常用场景 对数据高并发的读写 海量数据的读写 对数据高可延展性">
<meta property="og:type" content="article">
<meta property="og:title" content="redis">
<meta property="og:url" content="http://example.com/2022/12/15/Redis/index.html">
<meta property="og:site_name" content="MyBlog">
<meta property="og:description" content="Redis1、NoSQL1、概述NoSQL（not  only SQL ） 不仅仅是SQL，泛指非关系型数据库，NoSQL不依赖业务逻辑方式存储，而是以简单的key-Value 模式  存储，因此的 大大的增加了数据库的拓展能力  不遵守SQL标准 不支持ACID（原子性，一致性，隔离性，持久性） 远超于SQL的性能  2、NoSQL 常用场景 对数据高并发的读写 海量数据的读写 对数据高可延展性">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.hasdsd.cn/imgredis.png">
<meta property="article:published_time" content="2022-12-14T16:00:00.000Z">
<meta property="article:modified_time" content="2023-05-17T14:57:44.228Z">
<meta property="article:author" content="学不动学不懂学步冻">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.hasdsd.cn/imgredis.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2022/12/15/Redis/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'redis',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-05-17 22:57:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/118332734?v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('https://img.hasdsd.cn/imgredis.png')"><nav id="nav"><span id="blog-info"><a href="/" title="MyBlog"><img class="site-icon" src="https://img.hasdsd.cn/imgfb2ae9dbdd3daa91c227a2134d61fa92ae2c861c_full.jpg"/><span class="site-name">MyBlog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">redis</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-12-14T16:00:00.000Z" title="发表于 2022-12-15 00:00:00">2022-12-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-05-17T14:57:44.228Z" title="更新于 2023-05-17 22:57:44">2023-05-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="redis"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><h2 id="1、NoSQL"><a href="#1、NoSQL" class="headerlink" title="1、NoSQL"></a>1、NoSQL</h2><h3 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h3><p>NoSQL（not  only SQL ） 不仅仅是SQL，泛指非关系型数据库，NoSQL不依赖业务逻辑方式存储，而是以简单的key-Value 模式  存储，因此的 大大的增加了数据库的拓展能力</p>
<ul>
<li>不遵守SQL标准</li>
<li>不支持ACID（原子性，一致性，隔离性，持久性）</li>
<li>远超于SQL的性能</li>
</ul>
<h3 id="2、NoSQL-常用场景"><a href="#2、NoSQL-常用场景" class="headerlink" title="2、NoSQL 常用场景"></a>2、NoSQL 常用场景</h3><ul>
<li>对数据高并发的读写</li>
<li>海量数据的读写</li>
<li>对数据高可延展性</li>
</ul>
<h3 id="3、NoSQL不支持的场景"><a href="#3、NoSQL不支持的场景" class="headerlink" title="3、NoSQL不支持的场景"></a>3、NoSQL不支持的场景</h3><ul>
<li>需要事务支持</li>
<li>基于SQL的结构化查询存储，处理复杂的关系，需要即系查询</li>
<li>用不着SQL的和用了SQL也不行的情况就用NoSQL</li>
</ul>
<h3 id="4、安装Redis"><a href="#4、安装Redis" class="headerlink" title="4、安装Redis"></a>4、安装Redis</h3><p>首先要在Linux环境中安装，并且要求安装gcc，当我们电脑中安装有gcc时，我们需要对版本进行升级</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum -y install centos-release-scl</span><br><span class="line">yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils</span><br><span class="line">scl <span class="built_in">enable</span> devtoolset-9 bash</span><br><span class="line"><span class="built_in">echo</span> “<span class="built_in">source</span> /opt/rh/devtoolset-9/enable” &gt;&gt;/etc/profile　	</span><br></pre></td></tr></table></figure>

<p>之后安装redis, 将文件夹解压在我们创建的目录中</p>
<p>进入包下 输入 make 指令，而后输入指令 make install</p>
<p>安装完成后 打开redis.config文件 将其中的 </p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bind 127.0.0.1 #绑定ip：如果需要远程访问，可将此行注释，或绑定一个真实ip</span><br><span class="line">port 6379 #端口号 </span><br><span class="line">protected-mode yes #是否开启保护模式  改为no</span><br><span class="line">daemonize no #是否设为后台运行 改为 yes</span><br><span class="line">#requirepass foobared #密码设置  123456</span><br><span class="line">pidfile /var/run/redis_6379.pid #进程文件保存位置，redis运行后会在此位置自动生成</span><br><span class="line">logfile “” #日志文件保存位置</span><br><span class="line">dir ./ #redis位置</span><br></pre></td></tr></table></figure>

<p>配置防火墙</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=6379/tcp --permanent ----添加6379端口</span><br><span class="line">firewall-cmd --reload ----重启防火墙</span><br><span class="line">firewall-cmd --list-port -----查看所有开放端口号</span><br><span class="line">firewall-cmd --query-port=6379/tcp -----查看指定端口是否开放</span><br></pre></td></tr></table></figure>

<p>关闭redis:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli shutdown <span class="comment">#没有设置密码，运行此行代码</span></span><br></pre></td></tr></table></figure>

<p>redis启动服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-server   配置文件的绝对路径     （在/usr/local/bin目录下） </span><br></pre></td></tr></table></figure>

<p>redis 开启连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli</span><br></pre></td></tr></table></figure>

<h2 id="2、Redis的数据类型"><a href="#2、Redis的数据类型" class="headerlink" title="2、Redis的数据类型"></a>2、Redis的数据类型</h2><p>redis有五大数据类型：String（字符串）、List（列表）、Set（集合）、Hash（哈希），Zset（有序集合）</p>
<h3 id="Redis对键的操作"><a href="#Redis对键的操作" class="headerlink" title="Redis对键的操作"></a>Redis对键的操作</h3><ul>
<li>keys *  查看当前库的所有key</li>
<li>exists key 判断某个key是否存在</li>
<li>type key 查看你的key是什么类型</li>
<li>del key 查处指定的key数据</li>
<li>unlink key  根据value选择非阻塞删除（如果数据是个BigKey数据处理起来会非常慢，那么由于redis是单线程的，就会导致出现缓存队列，甚至会出现队列溢出）</li>
<li>expire key 10  给key设置10s的过期时间</li>
<li>ttl key 查看还有多少秒过期，-1为永不过期，-2表示已经过期</li>
<li>select dbindex   切换到数据库 0-15 默认为0</li>
<li>move key dbindex 将数据移动到该索引的数据库内</li>
<li>Redis一共有16个库，select 命令为切换数据库</li>
<li>dbsize查看当前数据库的key的数量</li>
<li>flushdb 清空当前库</li>
<li>flushall 通杀所有库</li>
</ul>
<p>Redis中的命令不区分大小写，但key与value区分大小写</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511124318066.png" alt="image-20230511124318066"></p>
<h3 id="Redis字符串（String）"><a href="#Redis字符串（String）" class="headerlink" title="Redis字符串（String）"></a>Redis字符串（String）</h3><h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4><ul>
<li><p>String是Redis最基础的类型，一个key对应一个value</p>
</li>
<li><p>String类型是二进制安全的，意味着Redis的String可以包含任何数据，例如jpg图片或者序列化的对象</p>
</li>
<li><p>String类型是Redis最基本的数据类型，Redis中字符串value最多可以使512M</p>
</li>
</ul>
<h4 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h4><p>set &lt; key&gt; &lt;value&gt; 添加键值对，倘若要设置两个相同的key那么其后者的将会覆盖前者</p>
<p>可选项：</p>
<ul>
<li><p><code>EX</code> <em>秒</em> – 设置指定的过期时间（以秒为单位），给key设置过期时间若超过已过期，则该key以及对应的value会被直接删除。</p>
</li>
<li><p><code>PX</code> <em>毫秒</em> – 设置指定的过期时间（以毫秒为单位）。</p>
</li>
<li><p><code>EXAT</code> <em>timestamp-seconds</em> – 设置key过期的指定 Unix 时间（以秒为单位）。</p>
</li>
<li><p><code>PXAT</code> <em>timestamp-毫秒</em> – 设置key过期的指定 Unix 时间（以毫秒为单位）。</p>
</li>
<li><p><code>NX</code>– 仅当key尚不存在时才设置key,若设置成功返回ok，若存在key则返回nil</p>
</li>
<li><p><code>XX</code>– 仅当key已存在时才设置密钥,若设置成功返回ok，若不存在key则返回nil</p>
</li>
<li><p><code>KEEPTTL</code>– 保留与key关联的生存时间，当我们对key设置了过期时间t1，当key被修改时，ttl就变成了当次set所制定的过期时间</p>
<p>而并非最开始设置的过期时间t1，但我们在某些业务场景下，需要保持这种key的ttl而不被set所修改，所以就用到了keepttl</p>
</li>
<li><p><code>GET</code>– 返回存储在键的旧字符串，如果键不存在，则返回 nil。如果存储在键的值不是字符串，则会返回并中止错误。</p>
</li>
</ul>
<p>示例：</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511130815473.png" alt="image-20230511130815473"><img src="https://img.hasdsd.cn/imgimage-20230511130940612.png" alt="image-20230511130940612"><img src="https://img.hasdsd.cn/imgimage-20230511131348655.png" alt="image-20230511131348655"></p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511131504714.png" alt="image-20230511131504714"><img src="https://img.hasdsd.cn/imgimage-20230511131651165.png" alt="image-20230511131651165"><img src="https://img.hasdsd.cn/imgimage-20230511132852631.png" alt="image-20230511132852631"></p>
<p>get &lt;key&gt; 通过key获得value</p>
<p>append  &lt;key&gt; &lt;value&gt; 将给定的 &lt;value&gt;追加到原值的末尾</p>
<p>strlen &lt;key&gt;获得值的长度</p>
<p>setnx &lt;key&gt; &lt;value&gt; 就是set &lt; key&gt; &lt;value&gt; if not exist &lt;key&gt;</p>
<p>incr &lt;key&gt;  将key中存储的数字值增1，只能对数字值的操作，如果为空，新增值为1</p>
<p>decr  &lt;key&gt; 将key中存储的数字值减1</p>
<p>mset  &lt; key1&gt; &lt;value1&gt;  &lt; key2&gt; &lt;value2&gt;  &lt; key3&gt; &lt;value3&gt;  …… 同时设置一个或多个key-value对</p>
<p>mget&lt; key1&gt;   &lt; key2&gt;  &lt; key3&gt;   ……  同时获取获取一个或多个value</p>
<p>msetnx   &lt; key1&gt; &lt;value1&gt;  &lt; key2&gt; &lt;value2&gt;  &lt; key3&gt; &lt;value3&gt;  ……  同时设置一个或多个key-value对，当且仅当所有给定的key都不存在时</p>
<p><strong>原子性</strong>，<strong>有一个失败则都失败</strong></p>
<p>incr <code>&lt;key&gt;</code>执行一次value +1，且返回+1后的值</p>
<p> incrby <code>&lt;key&gt;</code>  步长    执行一次value+步长，且返回执行后的值</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511134626243.png" alt="image-20230511134626243"></p>
<p>decr <code>&lt;key&gt;</code> 执行一次 value -1 ，并返回执行后的值</p>
<p> decrby <code>&lt;key&gt;</code>  步长    执行一次value-1步长，且返回执行后的值</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511134927565.png" alt="image-20230511134927565"></p>
<p>getrange &lt;key&gt; &lt;起始位置&gt; &lt;结束位置&gt; 获得值的范围，类似于java中的subString ，如果是 getrange k1 0 -1那么就是将value全部取出</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511133955005.png" alt="image-20230511133955005"></p>
<p>setrange &lt;key&gt; &lt;起始位置&gt;  &lt;value&gt;  用 &lt;value&gt; 覆盖&lt;key&gt; 所储存的字符串值，从起始位置开始</p>
<p>setex &lt;key&gt;&lt;过期时间&gt;&lt;vlalue&gt; 设置键值的同时，设置过期时间，单位为秒</p>
<p>getset &lt;key&gt;&lt;value&gt; 以旧换新 设置了新值同时获得旧值</p>
<h4 id="String类型的应用场景"><a href="#String类型的应用场景" class="headerlink" title="String类型的应用场景"></a>String类型的应用场景</h4><p>作品点赞，浏览量增加</p>
<h3 id="Redis列表（List）"><a href="#Redis列表（List）" class="headerlink" title="Redis列表（List）"></a>Redis列表（List）</h3><h4 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h4><p>单键多值</p>
<p>Redis列表是最简单的字符串列表，按照插入顺序排序，你可以添加一个元素到列表头部（左边）或者尾部（右边）</p>
<p>他的底层实际上是一个双向链表，容量是2的32次方减1个元素，大概40多亿，主要功能有push&#x2F;pop等，一般用在栈、队列、消息队列等场景。对两端操作性能很高，通过索引下标的操作中间的节点性能较差</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511140132281.png" alt="image-20230511140132281"></p>
<h4 id="常见命令"><a href="#常见命令" class="headerlink" title="常见命令"></a>常见命令</h4><p>lpush &#x2F;rpush  key  value1 vlaue2 value3 …… 从左边或右边插入一个或多个值</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511140445259.png" alt="image-20230511140445259"></p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511140531466.png" alt="image-20230511140531466"></p>
<p>lpop&#x2F;rpop key 从左边或右边吐出一个值。 (值在键在，值光键亡)</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511140630589.png" alt="image-20230511140630589"><img src="https://img.hasdsd.cn/imgimage-20230511140653944.png" alt="image-20230511140653944"></p>
<p>rpoplpush &lt;key1&gt; &lt;key2&gt; 从&lt;key1&gt;列表右边吐出一个值插到&lt;key2&gt;列表的左边</p>
<p>Irange  &lt;key&gt;&lt;start&gt;&lt;stop&gt; 按照索引下标获得元素（从左到右）</p>
<p> lindex &lt;key&gt; &lt;index&gt; 按照索引下表获得元素（从左到右）</p>
<p>llen &lt;key&gt;获得列表的长度</p>
<p>linsert &lt;key&gt; before&#x2F;after &lt;value&gt;  &lt;newvalue&gt;  在所指定的value前边&#x2F;后边插入newvalue</p>
<p>lrem &lt;key&gt; n  &lt;value&gt; 从左边删除n个value（从左到右） </p>
<p>ltrim <code>&lt;key&gt;</code> <code>&lt;start&gt;</code> <code>&lt;end&gt;</code>  截取 索引 start 到end之间的 元素 并返回给 key</p>
<p>lset &lt;key&gt; &lt;index&gt; &lt;value&gt; 将列表key下表为index的值替换为value</p>
<p>rpoplpush <code>&lt;key1&gt;</code>  <code>&lt;key2&gt;</code> 从 key1的最右侧队列弹出一个元素到key2队列的最左侧</p>
<h4 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h4><p>​	例如，倘若我在订阅的公众号发布两个文章，文章id分别是 9,10，我的喜欢文章 的key value为   likeArtcle:zf  9,10,……</p>
<p><strong>列表的数据结构</strong></p>
<p>List的数据结构为快速链表quickList,首先列表元素较少的情况下会使用一块连续的内存存储，这个结构是ziplist即压缩列表</p>
<p>他将所有的元素紧挨着一起存储，分配的是一块连续的内存，当数据量较多的时候才会改成quicklist</p>
<p>因为普通链表需要的附加指针空间太大，会比较浪费空间，比如这个列表存的只是int类型的数据，结构还需要额外增加两个指针prev和newx</p>
<p><img src="https://img.hasdsd.cn/imgimage-20221226002540698.png" alt="image-20221226002540698"></p>
<p> Redis将链表和ziplist结合起来组成quicklist，也就是将多个自拍list使用双向指针串联起来使用，这样既满足了快速的插入删除性能，又不会出现太大的空间冗余</p>
<h3 id="Redis集合Set"><a href="#Redis集合Set" class="headerlink" title="Redis集合Set"></a>Redis集合Set</h3><p>Set中的元素自动排重，不可重复</p>
<p><strong>常用指令</strong></p>
<p> sadd &lt;key&gt; &lt;value1&gt;&lt;value2&gt;……   将一个或多个member元素加入到集合key中，已经存在的member将被忽略</p>
<p>smembers &lt;key&gt; 取出该集合的所有值</p>
<p>sismember  &lt;key&gt; &lt;value&gt; 判断集合&lt;key&gt;是否含有&lt;value&gt;值，有1，没有0</p>
<p>scard &lt;key&gt; 返回该集合元素的个数 </p>
<p>srem &lt;key&gt; &lt;value1&gt; &lt;value2&gt; …… 删除集合中的某个元素</p>
<p>spop &lt;pop&gt; 随即从该集合中吐出一个值，集合中会去除这个值</p>
<p>srandmember  &lt;key&gt;  &lt;n&gt;  随机丛该集合中取出n个值，不会从集合中删除</p>
<p>smove  &lt;source&gt;  &lt;desination&gt; value  把一个集合中的一个值 移动到另一个集合中</p>
<p>sinter &lt;key1&gt; &lt;key2&gt; 返回两个集合的交集元素</p>
<p>sunion &lt;key1&gt; &lt;key2&gt; 返回两个集合并集的元素</p>
<p> sdiff &lt;key1&gt; &lt;key2&gt; 返回两个集合的差集元素 (key1中，但不在 key2中的  即为 k1 -k2)</p>
<p>set常用于社交软件中，例如我们的微信朋友圈点赞，假如我们发布了微信朋友圈，这时正好有两位朋友点赞，</p>
<p>我们就可以写成</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sadd pub:msgId 点赞用户1id 点赞用户2id </span><br></pre></td></tr></table></figure>

<p>​	有一人取消点赞</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">srem pub:masgId 点赞用户<span class="built_in">id</span></span><br></pre></td></tr></table></figure>

<p>展示所有点赞的用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smembers pub:msgId </span><br></pre></td></tr></table></figure>

<p>点赞用户数量统计</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scard pub:msgId </span><br></pre></td></tr></table></figure>

<p>再比如我们的交友软件</p>
<p>推荐你可能认识的人， 张三与李四是好友 李四与王五是好友</p>
<p>这时候我们是张三，系统推荐我们可能认识的人是王五那么可以用set来实现</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sdiff firend:diff 张三好友<span class="built_in">set</span>集合 李四好友<span class="built_in">set</span>集合</span><br></pre></td></tr></table></figure>

<p>例如抖音中的共同好友数量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sdiff firend:inter 张三好友<span class="built_in">set</span> 李四好友<span class="built_in">set</span></span><br></pre></td></tr></table></figure>



<p><strong>Set的数据结构</strong></p>
<p> Set数据结构是dict字典，字典是用哈希表实现的</p>
<p>Java中的HashSet的内部是用的是HashMap，只不过所有的value都指向了同一个对象，Redis中的Set结构也是一样，他的内部也使用了hash结构，所有的value都只想同一个内部值</p>
<h3 id="Redis-哈希（Hash）"><a href="#Redis-哈希（Hash）" class="headerlink" title="Redis 哈希（Hash）"></a>Redis 哈希（Hash）</h3><h4 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h4><p>Redis hash是一个键值对集合</p>
<p>Redis hash 是一个String类型的field和value 映射表，hash特别适合存储对象，类似于java中的Map<code>&lt;key,Map&lt;String,Object&gt;&gt;</code></p>
<h4 id="常用的命令"><a href="#常用的命令" class="headerlink" title="常用的命令"></a><strong>常用的命令</strong></h4><p>hset &lt;key&gt; &lt;field&gt; &lt;value&gt; 给 &lt;key&gt; 集合中的 &lt;field&gt;键赋值<code>&lt;value&gt;</code> </p>
<p>hget  &lt;key1&gt; &lt;field&gt;从&lt;key1&gt;集合 &lt;field&gt;取出value</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511180722640.png" alt="image-20230511180722640"></p>
<p>hash数据结构的用法非常广泛， 上述的例子就是一个典型的将对象存入redis中，利用的就是我们Hash数据结构，将对象001的信息存入其中</p>
<p>hmset&lt;key1&gt;&lt;field&gt;&lt;value1&gt; &lt;field2&gt;&lt;value2&gt; …… 批量设置hash的值</p>
<p>hmget&lt;key1&gt;  &lt;field&gt; &lt;field2&gt; …… 批量获取hash的值</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511181641468.png" alt="image-20230511181641468"></p>
<p>hgetall  <code>&lt;key&gt;</code> 获取key中所有field以及对应的value值</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230511181550242.png" alt="image-20230511181550242"></p>
<p>hexists &lt;key1&gt; &lt;field&gt;查看哈希表key中，给定域field 是否存在</p>
<p>hkeys &lt;key&gt; 列出该hash集合的所有field</p>
<p>hvals &lt;key&gt; 列出该hash 集合所有的value</p>
<p>hincrby &lt;key&gt;&lt;field&gt;&lt;increment&gt; 为哈希表 key 中的域 field的值加上 整数increment </p>
<p>hincrbyfloat 	 &lt;key&gt;&lt;field&gt;&lt;increment&gt; 为哈希表 key 中的域 field的值加上 小数increment </p>
<p>hsetnx &lt;key&gt; &lt;field&gt; &lt;value&gt;将哈希表key 中的域field 的值设置为value,当且仅当field不存在</p>
<p><strong>Hash的数据结构</strong></p>
<p>Hash类型对应的数据结构是两种，ziplist(压缩列表),hashtable(哈希表),当field-value长度较短且个数较少时，使用ziplist否则使用hashtable</p>
<h3 id="Redis有序集合Zset（sorted-set）"><a href="#Redis有序集合Zset（sorted-set）" class="headerlink" title="Redis有序集合Zset（sorted set）"></a>Redis有序集合Zset（sorted set）</h3><p>Redis有序集合zset与普通集合set非常类似，是一个没有重复元素的字符串集合</p>
<p>不同之处是有序集合的每个成员都关联了一个评分（score) ，这个评分被用来按照最低分到最高分的方式排序集合中的成员，集合成员是唯一的，但是评分可以是重复的</p>
<p>因为元素是有序的，所以你可可以很快的根据评分或者次序来获取一个范围的元素，访问有序集合的中间元素也是非常快的因此你能够使用有序集合作为一个没有重复成员的智能列表</p>
<p><strong>常用的命令</strong></p>
<p>zadd &lt;key&gt; &lt;score1&gt;&lt;value&gt; &lt;score2&gt;&lt;value2&gt;……</p>
<p>将一个或多个member元素及其score值加入到有序集key当中</p>
<p>zrange &lt;key&gt; &lt;start&gt; &lt;stop&gt; [WITHSCORES]  返回有序集key中，下标在&lt; start&gt; &lt;stop&gt;之间的元素 带WITHSCORES，可以让分数一起和值返回到结果集</p>
<p>zrangebyscore key min max [withscores] [limit offset count]  返回有序集（升序）key中，所有score值介于 min和max 之间（包括等于min或max）的成员</p>
<p>zrevrangebyscore key max min  返回有序集key中，所有score值介于min和max之间，降序</p>
<p>zincrby &lt;key&gt; &lt;increment&gt;&lt;value&gt; 为元素的score加上增加 increment</p>
<p>zrem &lt;key&gt; &lt;value&gt; 删除该集合下，指定值的元素</p>
<p>zcount &lt;key&gt; &lt;min&gt; &lt;max&gt; 统计该集合，分数之间的元素个数</p>
<p>zpopMax <code>&lt;key&gt;</code>  conunt  弹出key集合中最大值的score的value</p>
<p>zpopMin <code>&lt;key&gt;</code>  conunt  弹出key集合中最小值的score的value</p>
<p>zrank &lt;key&gt; &lt;value&gt; 返回该值在集合中的排名，从0开始</p>
<p>应用非常滴广泛，例如我们要对商城中的商品进行销量统计 </p>
<p>其中 12件2002 13 件2003 ……</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zadd good:sellsort 12 2002 13 2003 18 2004 24 2005 241 2006 1 2007 0 2008</span><br></pre></td></tr></table></figure>

<p>又有两名用户下单了商品2004 且有20名用户下单2008</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ZINCRBY good:sellsort 2 2004</span><br><span class="line">ZINCRBY good:sellsort 20 2008</span><br></pre></td></tr></table></figure>

<p>求前三名的销量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZrevRANGE good:sellsort 0 2</span><br></pre></td></tr></table></figure>









<p><strong>Zset数据结构</strong></p>
<p>ScoreSet（Zset）是Redis提供的一个非常特别的数据结构，一方面它等价于Java的数据结构Map&lt;String,Double&gt; 可以给每个元素value赋予一个权重score，另一方面他又类似于TreeSet，内部元素会按照权重score进行排序，可以得到每个元素的名词，还可以通过score的范围来获取元素的列表</p>
<p>Zset底层使用了两个数据结构：</p>
<ol>
<li><p>hash，hash的作用就是关联元素value和权重score，保证元素value的唯一性，可以通过元素value找到相应的score值</p>
</li>
<li><p>跳跃表，表余额表的目的在于给元素value进行排序，根据score的范围获取元素列表</p>
<h4 id="跳跃表"><a href="#跳跃表" class="headerlink" title="跳跃表"></a><strong>跳跃表</strong></h4><p>有序集合在生活中比较常见，例如根据成绩对学生排名，根据得分对玩家排名等，对于有序集合的底层实现就可以用数组、平衡树、链表等，数组不便元素的插入删除；平衡树或红黑树虽然效率高但是结构复杂，连表查询需要遍历所有效率低，Redis使用的是跳跃表，跳跃表效率堪比红黑树，实现远比红黑树简单 ， 其他了解请见博客<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45480785/article/details/116293416">https://blog.csdn.net/weixin_45480785/article/details/116293416</a></p>
</li>
</ol>
<h2 id="3、Redis中的发布与订阅"><a href="#3、Redis中的发布与订阅" class="headerlink" title="3、Redis中的发布与订阅"></a>3、Redis中的发布与订阅</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Redis发布订阅（pub&#x2F;sub）是一种消息通信模式：发送者（pub）发送消息，订阅者（sub）接收消息，Redis客户端可以订阅任意数量的频道</p>
<h3 id="发布订阅命令行实现"><a href="#发布订阅命令行实现" class="headerlink" title="发布订阅命令行实现"></a>发布订阅命令行实现</h3><p>1、打开一个客户端订阅channnel1</p>
<p>SUBSCRIBE channel1</p>
<p>2、打开另一个客户端发送消息</p>
<p>publish channel1 hello</p>
<p>3、回到订阅消息的客户端</p>
<p><img src="https://img.hasdsd.cn/imgimage-20221227001734316.png" alt="image-20221227001734316"></p>
<h2 id="4、Redis7新数据类型"><a href="#4、Redis7新数据类型" class="headerlink" title="4、Redis7新数据类型"></a>4、Redis7新数据类型</h2><h3 id="redis-位域-bitfield"><a href="#redis-位域-bitfield" class="headerlink" title="redis 位域(bitfield)"></a>redis 位域(bitfield)</h3><p>通过bitfield命令可以一次性操作多个比特位域(指的是连续的多个比特位)，它会执行一系列操作并返回一个响应数组，这个数组中的元素对应参数列表中的相应操作的执行结果。<br>说白了就是通过bitfield命令我们可以一次性对多个比特位域进行操作。</p>
<h3 id="redis流（stream）"><a href="#redis流（stream）" class="headerlink" title="redis流（stream）"></a>redis流（stream）</h3><p>Redis Stream主要用于消息队列(MQ，Message Queue), Redis 本身是有一个Redis 发布订阅(pub&#x2F;sub)来实现消息队列的功能，但它有个缺点就是消息无法持久化，如果出现网络断开、Redis 宕机等，消息就会被丢弃。</p>
<p>简单来说发布订阅(pub&#x2F;sub)可以分发消息，但无法记录历史消息。而Redis Stream 提供了消息的持久化和主备复制功能，可以让任何客户端访问任何时刻的数据，并且能记住每一个客户端的访问位置，还能保证消息不丢失</p>
<p>stream流</p>
<p>实现消息队列，它支持消息的持久化、支持自动生成全局唯一ID、支持ack确认消息的模式、支持消费组模式等，让消息队列更加的稳定和可靠</p>
<ul>
<li>添加队列消息到队列末尾</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xadd key ID field1 value1 field2 value2</span><br><span class="line"><span class="comment"># * 表示为消息id，使用* 后表示又redis替我们生成，可以自定义，但是要保证递增性，*表示让 Redis 自动生成唯一的消息 ID</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.hasdsd.cn/imgimage-20230515161314141.png" alt="image-20230515161314141"></p>
<ul>
<li>用于获取消息列表，忽略已经删除的消息</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xrange key  start  end   count 升序</span><br><span class="line">xrerange key end start count  降序</span><br><span class="line"><span class="comment">#其中 start 表示开始值 + 表示最大值，end表示结束值 +表示为最大值 count表示最多获取多少个值</span></span><br></pre></td></tr></table></figure>

<ul>
<li>用于消息删除</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xdel key  <span class="built_in">id</span>   </span><br></pre></td></tr></table></figure>

<p><img src="https://img.hasdsd.cn/imgimage-20230515161943733.png" alt="image-20230515161943733"></p>
<ul>
<li>返回消息队列的长度</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xlen  key	</span><br></pre></td></tr></table></figure>

<ul>
<li>用于对stream的长度进行截取，如超长会进行截取</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xtrim  key  maxlen  n</span><br><span class="line"><span class="comment">#n 为最大长度</span></span><br><span class="line">xtrim key minid   <span class="built_in">id</span></span><br><span class="line"><span class="comment">#去除队列中最小的id，倘若比该id还要小也一起被删除</span></span><br></pre></td></tr></table></figure>

<ul>
<li>读取队列中的消息<ul>
<li>非阻塞</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xread count n streams key  <span class="built_in">id</span></span><br><span class="line"><span class="comment">#n为读取的最大数  </span></span><br><span class="line"><span class="comment">#  $代表特殊ID，表示以当前Stream已经存储的最大的ID作为最后一个ID，当前Stream中不存在大于当前最大ID的消息，因此此时返回nil</span></span><br><span class="line"><span class="comment">#	0-O代表从最小的ID开始获取Stream中的消息，当不指定count，将会返回Stream中的所有消息，注意也可以使用O(O0/000也都是可以的</span></span><br></pre></td></tr></table></figure>

<ul>
<li>阻塞</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xread count n   block  <span class="built_in">timeout</span>   stream key <span class="built_in">id</span></span><br><span class="line"><span class="comment">#读取消息时，只需要增加 BLOCK 参数即可支持「阻塞式」拉取消息。</span></span><br><span class="line"><span class="comment"># BLOCK timeout 表示阻塞等待，timeout表示超时时间， 0为 不设置超时时间</span></span><br></pre></td></tr></table></figure>

<p>利用redis stream的阻塞队列实现 生产者 消费者</p>
<p>我们开启两个redis 会话 session1 session2</p>
<p>此时 session1  （消费者）作为我们的消费者开始实时监听 消息队列mystream中的新消息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xread count 1 block 0  streams  mystream  $</span><br><span class="line"><span class="comment">#我们设置的获取消息的数量为1 超时时间为 0 ，$为比当前队列中的最大id更大的id   监听队列中的新消息</span></span><br></pre></td></tr></table></figure>

<p>此时我们的session2（生产者） 作为我们的生产者开始生产一条消息 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xadd mystream * kf vf</span><br></pre></td></tr></table></figure>

<p>此时session1 获取到了消息</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230515170447244.png" alt="image-20230515170447244"></p>
<p>消费者组</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建消费组</span></span><br><span class="line">xgroup create  key groupname  <span class="built_in">id</span></span><br><span class="line"><span class="comment">#对于id  $ 表示从队尾开始消费</span></span><br><span class="line">		0 表示从队首开始消费  队尾新来</span><br><span class="line"><span class="comment">#指定消费组的消费者消费消息</span></span><br><span class="line">XREADGROUP group  groupname  consumername  count n streams key  &gt;</span><br><span class="line"><span class="comment"># &gt;表示游标读取  n为读取消息数量</span></span><br></pre></td></tr></table></figure>

<p>stream中的消息—旦被消费组里的一个消费者读取了，就不能再被该消费组内的具他消费者读取了，即同—个消费组里的消费者不能消费同—条消息XREADGROUP命令再执行—次，此时读到的就是空值</p>
<p>消费组的目的：</p>
<p>让组内的多个消费者共同分担读取消息，所以，我们通常会让每个消费者读取部分消息，从而实现消息读取负载在多个消费者间是均衡分布的</p>
<p>如何知道读取的消息是否ack了呢</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">XPENDING key groupname start end  n  consumername</span><br><span class="line"><span class="comment">#n为显示的数量</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.hasdsd.cn/imgimage-20230515215649319.png" alt="image-20230515215649319"></p>
<p>ACK 答复</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XACK key groupName <span class="built_in">id</span> 	</span><br></pre></td></tr></table></figure>















<h3 id="bitmaps（位图）"><a href="#bitmaps（位图）" class="headerlink" title="bitmaps（位图）"></a>bitmaps（位图）</h3><p>Bitmaps 称为位图，它不是一种数据类型。网上很多视频教程把Bitmaps称为数据类型，应该是不正确的。Bitmaps 是Redis提供给使用者用于操作位的“数据类型”。它主要有如下的基本特性：</p>
<ul>
<li>Bitmaps 不是数据类型，底层就是字符串（key-value），byte数组。我们可以使用普通的get&#x2F;set直接获取和设值位图的内容，也可以通过Redis提供的位图操作getbit&#x2F;setbit等将byte数组看成“位数组”来处理</li>
<li>Bitmaps 的“位数组”每个单元格只能存储0和1，数组的下标在Bitmaps中称为偏移量</li>
<li>Bitmaps设置时key不存在会自动生成一个新的字符串，如果设置的偏移量超出了现有内容的范围，就会自动将位数组进行零扩充</li>
</ul>
<p><img src="https://img.hasdsd.cn/imgimage-20221227201847546.png" alt="image-20221227201847546"></p>
<p>常用命令 </p>
<p><strong>setbit  key offset value</strong>     对key存储的字符串，设置或者清除指定偏移量上的位（bit），位的设置或者清除取决于value参数，0&#x2F;1；当key不存在时，自动生成一个新的字符串。字符串会进行伸展确保value保存在指定的偏移量上。字符串进行伸展时，空白位置以0填充</p>
<p>例如使用Bitmaps来存储用户是否打卡，打卡记做1，未打卡为0，用户的id作为偏移量<br>假设存在10个用户，此时用户1、3、5、9、10打了卡，其他人未打卡，Bitmaps的初始化结果如下所示：</p>
<p><img src="https://img.hasdsd.cn/imgimage-20221227202452540.png" alt="image-20221227202452540"></p>
<p> GETBIT key offset      </p>
<p>获取指定偏移量上的位（bit），当offset比字符串长度大，或者key不存在，返回0；</p>
<p><img src="https://img.hasdsd.cn/imgimage-20221227202717804.png" alt="image-20221227202717804"></p>
<p>strlen key</p>
<p>获取bitmap的字节数</p>
<p>不是字符串长度而是占据几个字节，超过8位后自己按照8位一组一byte再扩容 </p>
<p>BITCOUNT key [start] [end]</p>
<p>计算给定字符串中，被设置为1的bit位的数量。start和end参数可以指定查询的范围，可以使用负数值。-1代表最后一个字节，-2代表倒是第二个字节。<br> <strong>注意：start和end是字节索引，因此每增加1 代表的是增加一个字符，也就是8位，所以位的查询范围必须是8的倍数。</strong></p>
<p>当我插入 1 3 5 8 10 占位为1 时</p>
<p>当我们使用命令BITCOUNT  clock:20221227 0 1 时， 我们会输出5（01010100 10100000 00000000）</p>
<p><img src="https://img.hasdsd.cn/imgimage-20221227203541187.png" alt="image-20221227203541187"></p>
<p>当我们输入命令 bitcount clock:20221227 0 0 时 我们会输出 3 （01010100）</p>
<p><img src="https://img.hasdsd.cn/imgimage-20221227203850444.png" alt="image-20221227203850444"></p>
<p>当我们输入命令 bitcount clock:20221227 1 1 时我们会输出 2（10100000）</p>
<p><img src="https://img.hasdsd.cn/imgimage-20221227203932393.png" alt="image-20221227203932393"></p>
<p>当我们输入命令 bitcount clock:20221227 2 2 时我们会输出 0 （00000000）</p>
<p><img src="https://img.hasdsd.cn/imgimage-20221227204150513.png" alt="image-20221227204150513"></p>
<p>BITOP operation destkey key [key …]</p>
<p>Redis的Bitmaps提供BITOP指令来对一个或多个（除了NOT操作）二进制位的字符串key进行位元操作，操作的结果保存到destkey上，operation是操作类型，有四种分别是：AND、OR、NOT、XOR</p>
<ul>
<li><p>BITOP AND destkey key [key …] ，对一个或多个 key 求逻辑并，并将结果保存到 destkey</p>
</li>
<li><p>BITOP OR destkey key [key …] ，对一个或多个 key 求逻辑或，并将结果保存到 destkey</p>
</li>
<li><p>BITOP XOR destkey key [key …] ，对一个或多个 key 求逻辑异或，并将结果保存到 destkey</p>
</li>
<li><p>BITOP NOT destkey key ，对给定 key 求逻辑非，并将结果保存到 destkey</p>
</li>
</ul>
<h3 id="HyperLogLog"><a href="#HyperLogLog" class="headerlink" title="HyperLogLog"></a>HyperLogLog</h3><p>Redis HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定 的、并且是很小的。</p>
<p>在 Redis 里面，每个 HyperLogLog 键只需要花费 12 KB 内存，就可以计算接近 2^64 个不同元素的基 数。这和计算基数时，元素越多耗费内存就越多的集合形成鲜明对比。</p>
<p>但是，因为 HyperLogLog 只会根据输入元素来计算基数，而不会储存输入元素本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。</p>
<p>pfadd key value1 value2 value3 ……  存储多个基数，自动去重</p>
<p>pfcount key   计算基数的数量</p>
<p>pfmerge  list  key1 key2  将key1 key2 中的基数的并集储存在list中</p>
<h3 id="Geospatial"><a href="#Geospatial" class="headerlink" title="Geospatial"></a>Geospatial</h3><p>可储存地理位置的经纬度，如果出现中文乱码则要在进入客户端之前添加属性 –raw</p>
<p>geoadd key 经度 维度 城市  经度2 维度2 城市2 …… 储存各个城市的经纬度</p>
<p>geopos key 城市1  城市2 ……                               输出城市的经纬度</p>
<p>geohash key 城市1 城市 2                     返回城市坐标使用geohash 表示 	</p>
<p>geodist key 城市1 城市2  单位（m,km,mi,ft） 输出城市之间的距离</p>
<p>georadius  key  经度 维度  半径  单位（m,km,mi,ft） 以该经纬度圆心做半径的圆包括哪些城市</p>
<h2 id="5、jedis"><a href="#5、jedis" class="headerlink" title="5、jedis"></a>5、jedis</h2><p>导入依赖坐标</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.6.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用java操作redis数据库</p>
<p>创建链接</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Jedis jedis=<span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;192.168.26.131&quot;</span>,<span class="number">6379</span>,<span class="number">0</span>); 远程链接的IP地址，端口号</span><br><span class="line">jedis.auth(<span class="string">&quot;123456&quot;</span>); 密码</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>其中有许多API操作</p>
<p>list 集合操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">jedis.set(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;value&quot;</span>)增添键值</span><br><span class="line">jedis.del(<span class="string">&quot;key&quot;</span>)  删除键key</span><br><span class="line">jedis.get(<span class="string">&quot;key&quot;</span>)  获取键key的value值</span><br><span class="line">jedis.append(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;value2&quot;</span>)追加增添键key的值value2</span><br><span class="line">jedis.lpush(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>,<span class="string">&quot;4&quot;</span>);向key为键的list增加值 <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line">jedis.lrange(<span class="string">&quot;key&quot;</span>,<span class="number">0</span>,-<span class="number">1</span>)  将key键的list 从<span class="number">0</span>索引到-<span class="number">1</span>索引全部到一个java类型的list中</span><br></pre></td></tr></table></figure>

<p>set集合操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jedis.sadd(<span class="string">&quot;names&quot;</span>,<span class="string">&quot;zf&quot;</span>,<span class="string">&quot;zhm&quot;</span>,<span class="string">&quot;666666&quot;</span>); 以names为键，后续的几个字符串作为值</span><br><span class="line">jedis.smembers(<span class="string">&quot;names&quot;</span>); 将value作为Java类型的Set进行封装</span><br></pre></td></tr></table></figure>

<p>hash集合操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jedis.hset(<span class="string">&quot;users&quot;</span>,<span class="string">&quot;name&quot;</span>,<span class="string">&quot;zf&quot;</span>);  创建以 users 为键 ，name 为 field  zf 为 值的一个hash 数据结构</span><br><span class="line">jedis.hget(<span class="string">&quot;users&quot;</span>,<span class="string">&quot;name&quot;</span>)  获取 users 为键，name为field的hash 的value</span><br></pre></td></tr></table></figure>

<p>Zset集合操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jedis.zadd(<span class="string">&quot;programs&quot;</span>,<span class="number">100</span>,<span class="string">&quot;python&quot;</span>); </span><br><span class="line">jedis.zadd(<span class="string">&quot;programs&quot;</span>,<span class="number">200</span>,<span class="string">&quot;c++&quot;</span>);</span><br><span class="line">jedis.zadd(<span class="string">&quot;programs&quot;</span>,<span class="number">300</span>,<span class="string">&quot;javaScript&quot;</span>);</span><br><span class="line">jedis.zadd(<span class="string">&quot;programs&quot;</span>,<span class="number">400</span>,<span class="string">&quot;java&quot;</span>);</span><br><span class="line">创建key为programs score 为 <span class="number">100</span> <span class="number">200</span> <span class="number">300</span> <span class="number">400</span> 值分别为 python c++ javaScript java 的Zset对象</span><br><span class="line">Set&lt;String&gt; programs = jedis.zrange(<span class="string">&quot;programs&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">将key为programs的Zset 从索引<span class="number">0</span>到-<span class="number">1</span>(输出全部)的value值，按照其分别的score进行排序并且输出</span><br></pre></td></tr></table></figure>

<h2 id="SpringDataRedis"><a href="#SpringDataRedis" class="headerlink" title="SpringDataRedis"></a>SpringDataRedis</h2><p>SpringData是Spring中数据操作的模块，包含对各种数据库的集成 ，其中对Redis的集成模块就叫做SpringDataRedis</p>
<ul>
<li>提供了对不同Redis客户端的整合（Lettuce和Jedis）</li>
<li>提供了RedisTemplate统一API来操作Redis</li>
<li>支持Redis的发布订阅模型</li>
<li>支持Redis烧饼和Redis集群</li>
<li>支持基于lettuce的响应式编程</li>
<li>支持基于JDK、JSON、字符串、Spring对象的数据序列化以及反序列化</li>
<li>支持基于Redis的JDKCollection实现</li>
</ul>
<h3 id="SpringDataRedis快速入门"><a href="#SpringDataRedis快速入门" class="headerlink" title="SpringDataRedis快速入门"></a>SpringDataRedis快速入门</h3><p>SpringDataRedis提供了RedisTemplate工具类，其中就封装了各种对Redis的操作，并将不同数据类型的操作API封装到不同的类型中</p>
<p>API：redisTemplate.opsForValue()  返回值类型： ValueOperations 说明：操作String类型数据</p>
<p>API：redisTemplate.opsForHash 返回值类型： HashOperations 说明：操作Hash类型数据</p>
<p>API：redisTemplate.opsForList()  返回值类型： ListOperations 说明：操作List类型数据</p>
<p>API：redisTemplate.opsForSet()  返回值类型： SetOperations 说明：操作Set类型数据</p>
<p>API：redisTemplate.opsForZSet()  返回值类型： ZSetOperations 说明：操作ZSet类型数据</p>
<h3 id="使用SpringDataRedis"><a href="#使用SpringDataRedis" class="headerlink" title="使用SpringDataRedis"></a>使用SpringDataRedis</h3><p>首先要导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Redis依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!--连接池依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p> 配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  redis:</span><br><span class="line">    #redis服务器地址</span><br><span class="line">    host: 192.168.26.132</span><br><span class="line">    #redis服务器端口</span><br><span class="line">    port: 6379</span><br><span class="line">    #redis数据库索引</span><br><span class="line">    database: 0</span><br><span class="line">    lettuce:</span><br><span class="line">      pool:</span><br><span class="line">        #连接池最大连接</span><br><span class="line">        max-active: 20</span><br><span class="line">        #连接池最大连接数</span><br><span class="line">        max-idle: 5</span><br><span class="line">        #连接池中的最小空闲连接</span><br><span class="line">        min-idle: 0</span><br><span class="line">        #最大连接等待时长</span><br><span class="line">        max-wait: 100</span><br><span class="line">    password: 123456</span><br></pre></td></tr></table></figure>

<p>编码测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisTestController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testRedis</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//设置值到redis</span></span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;lucy&quot;</span>);</span><br><span class="line">        <span class="comment">//从redis获取值</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span>redisTemplate.opsForValue().get(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是这样操作会带来一些列问题，当我们在redis去get key时我们并不能get到 我们在RedisTemplate所set的值，当我们查看却发现</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230114203640729.png" alt="image-20230114203640729"></p>
<p>这是为什么呢？</p>
<p>当RedisTemplate可以接收人意Object作为值写入Redis，只不过写入前会把Object序列化为字节形式，默认是采用JDK序列化，得到的结果就是这样，这样写不仅可读性差，而且内存占用大</p>
<p> 如何处理？</p>
<p>在RedisTemplate源码中，有RedisSerializer与Jackson2JsonRedisSerializer会实现key与value 的序列化，我们使用RedisSerializer作为key 的序列化方式，将Jackson2JsonRedisSerializer作为Value的Object类型的转换，我们可以将配置写在RedisConfig中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.redisboot.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.RedisConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.StringRedisSerializer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedisTemplate&lt;String,Object&gt; <span class="title function_">redisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span>&#123;</span><br><span class="line">     <span class="comment">//创建RedisTemplate对象</span></span><br><span class="line">        RedisTemplate&lt;String, Object&gt; template = <span class="keyword">new</span> <span class="title class_">RedisTemplate</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//设置连接工厂</span></span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        <span class="comment">//创建JSON序列化连接工具</span></span><br><span class="line">        <span class="type">GenericJackson2JsonRedisSerializer</span> <span class="variable">genericJackson2JsonRedisSerializer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GenericJackson2JsonRedisSerializer</span>();</span><br><span class="line">        <span class="comment">//设置key的序列化</span></span><br><span class="line">        template.setKeySerializer(StringRedisSerializer.UTF_8);</span><br><span class="line">        template.setHashKeySerializer(StringRedisSerializer.UTF_8);</span><br><span class="line">        <span class="comment">//设置value的序列化</span></span><br><span class="line">        template.setValueSerializer(genericJackson2JsonRedisSerializer);</span><br><span class="line">        template.setHashValueSerializer(genericJackson2JsonRedisSerializer);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当我们存入对象时</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230114213024518.png" alt="image-20230114213024518"></p>
<p>我们会存入对象类的包名，还有其中的属性及其值</p>
<h2 id="6、Springboot整合redis"><a href="#6、Springboot整合redis" class="headerlink" title="6、Springboot整合redis"></a>6、Springboot整合redis</h2><p>首先要在SpringBoot项目中导入maven依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--redis--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--spring集成redis所需commons-pool2--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在配置文件中写入相关配置</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="comment">#redis服务器地址</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">hasdsd.cn</span></span><br><span class="line">    <span class="comment">#redis服务器端口</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">    <span class="comment">#redis数据库索引</span></span><br><span class="line">    <span class="attr">database:</span> <span class="number">0</span></span><br><span class="line">    <span class="attr">lettuce:</span></span><br><span class="line">      <span class="attr">pool:</span></span><br><span class="line">        <span class="attr">shutdown-timeout:</span> <span class="number">100</span></span><br><span class="line">        <span class="attr">max-active:</span> <span class="number">20</span></span><br><span class="line">        <span class="comment">#最大阻塞等待时间（负数没有限制）</span></span><br><span class="line">        <span class="attr">max-wait:</span> <span class="number">-1</span></span><br><span class="line">        <span class="comment">#连接池中的最大空闲连接</span></span><br><span class="line">        <span class="attr">max-idle:</span> <span class="number">5</span></span><br><span class="line">        <span class="comment">#连接池中的最小空闲连接</span></span><br><span class="line">        <span class="attr">min-idle:</span> <span class="number">0</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5000</span></span><br></pre></td></tr></table></figure>

<p>添加redis配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.redisboot.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonAutoDetect;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.PropertyAccessor;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.CachingConfigurerSupport;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.EnableCaching;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.RedisConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.StringRedisSerializer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * redis配置类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisConfig</span> <span class="keyword">extends</span> <span class="title class_">CachingConfigurerSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * retemplate相关配置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> factory</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="title function_">redisTemplate</span><span class="params">(RedisConnectionFactory factory)</span> &#123;</span><br><span class="line"></span><br><span class="line">        RedisTemplate&lt;String, Object&gt; template = <span class="keyword">new</span> <span class="title class_">RedisTemplate</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// 配置连接工厂</span></span><br><span class="line">        template.setConnectionFactory(factory);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用Jackson2JsonRedisSerializer来序列化和反序列化redis的value值（默认使用JDK的序列化方式）</span></span><br><span class="line">        <span class="type">Jackson2JsonRedisSerializer</span> <span class="variable">jacksonSeial</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jackson2JsonRedisSerializer</span>(Object.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">om</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        <span class="comment">// 指定要序列化的域，field,get和set,以及修饰符范围，ANY是都有包括private和public</span></span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        <span class="comment">// 指定序列化输入的类型，类必须是非final修饰的，final修饰的类，比如String,Integer等会跑出异常</span></span><br><span class="line">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">        jacksonSeial.setObjectMapper(om);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 值采用json序列化</span></span><br><span class="line">        template.setValueSerializer(jacksonSeial);</span><br><span class="line">        <span class="comment">//使用StringRedisSerializer来序列化和反序列化redis的key值</span></span><br><span class="line">        template.setKeySerializer(<span class="keyword">new</span> <span class="title class_">StringRedisSerializer</span>());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置hash key 和value序列化模式</span></span><br><span class="line">        template.setHashKeySerializer(<span class="keyword">new</span> <span class="title class_">StringRedisSerializer</span>());</span><br><span class="line">        template.setHashValueSerializer(jacksonSeial);</span><br><span class="line">        template.afterPropertiesSet();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对hash类型的数据操作</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> redisTemplate</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> HashOperations&lt;String, String, Object&gt; <span class="title function_">hashOperations</span><span class="params">(RedisTemplate&lt;String, Object&gt; redisTemplate)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对redis字符串类型数据操作</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> redisTemplate</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ValueOperations&lt;String, Object&gt; <span class="title function_">valueOperations</span><span class="params">(RedisTemplate&lt;String, Object&gt; redisTemplate)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对链表类型的数据操作</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> redisTemplate</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ListOperations&lt;String, Object&gt; <span class="title function_">listOperations</span><span class="params">(RedisTemplate&lt;String, Object&gt; redisTemplate)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对无序集合类型的数据操作</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> redisTemplate</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SetOperations&lt;String, Object&gt; <span class="title function_">setOperations</span><span class="params">(RedisTemplate&lt;String, Object&gt; redisTemplate)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForSet();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对有序集合类型的数据操作</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> redisTemplate</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ZSetOperations&lt;String, Object&gt; <span class="title function_">zSetOperations</span><span class="params">(RedisTemplate&lt;String, Object&gt; redisTemplate)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForZSet();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Redis工具类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxxx.utils;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.CollectionUtils;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Redis工具类</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zlpt</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020年11月17日</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">RedisUtils</span> &#123;</span><br><span class="line">    <span class="comment">//  直接用RedisTemplate操作Redis，需要很多行代码，因此直接封装好一个RedisUtil，这样写代码更方便点。这个RedisUtil交给Spring容器实例化，使用时直接注解注入。</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line">    <span class="comment">// =============================common============================</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 指定缓存失效时间</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time 时间(秒)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">expire</span><span class="params">(String key, <span class="type">long</span> time)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                redisTemplate.expire(key, time, TimeUnit.SECONDS);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据key 获取过期时间</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 键 不能为null</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 时间(秒) 返回0代表为永久有效</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getExpire</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.getExpire(key, TimeUnit.SECONDS);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断key是否存在</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true 存在 false不存在</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasKey</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.hasKey(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key ...表示可以传一个值 或多个</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(String... key)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (key != <span class="literal">null</span> &amp;&amp; key.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (key.length == <span class="number">1</span>) &#123;</span><br><span class="line">                redisTemplate.delete(key[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                redisTemplate.delete((Collection&lt;String&gt;) CollectionUtils.arrayToList(key));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ============================String=============================</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 普通缓存获取</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">get</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> key == <span class="literal">null</span> ? <span class="literal">null</span> : redisTemplate.opsForValue().get(key);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 普通缓存放入</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true成功 false失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">set</span><span class="params">(String key, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForValue().set(key, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 普通缓存放入并设置时间</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  时间(秒) time要大于0 如果time小于等于0 将设置无限期</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true成功 false 失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">set</span><span class="params">(String key, Object value, <span class="type">long</span> time)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                redisTemplate.opsForValue().set(key, value, time, TimeUnit.SECONDS);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                set(key, value);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递增</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> delta 要增加几(大于0)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">incr</span><span class="params">(String key, <span class="type">long</span> delta)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (delta &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;递增因子必须大于0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForValue().increment(key, delta);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递减</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> delta 要减少几(小于0)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">decr</span><span class="params">(String key, <span class="type">long</span> delta)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (delta &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;递减因子必须大于0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForValue().increment(key, -delta);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// ================================Map=================================</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * HashGet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  键 不能为null</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item 项 不能为null</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">hget</span><span class="params">(String key, String item)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().get(key, item);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取所有给定字段的值</span></span><br><span class="line"><span class="comment">     * author: xu</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;Object, Object&gt; <span class="title function_">hgetall</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().entries(key);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取hashKey对应的所有键值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 对应的多个键值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;Object, Object&gt; <span class="title function_">hmget</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().entries(key);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * HashSet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map 对应多个键值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true 成功 false 失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hmset</span><span class="params">(String key, Map&lt;String, Object&gt; map)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().putAll(key, map);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * HashSet 并设置时间</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map  对应多个键值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time 时间(秒)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true成功 false失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hmset</span><span class="params">(String key, Map&lt;String, Object&gt; map, <span class="type">long</span> time)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().putAll(key, map);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                expire(key, time);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 向一张hash表中放入数据,如果不存在将创建</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item  项</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true 成功 false失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hset</span><span class="params">(String key, String item, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().put(key, item, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 向一张hash表中放入数据,如果不存在将创建</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item  项</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  时间(秒) 注意:如果已存在的hash表有时间,这里将会替换原有的时间</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true 成功 false失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hset</span><span class="params">(String key, String item, Object value, <span class="type">long</span> time)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().put(key, item, value);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                expire(key, time);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除hash表中的值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  键 不能为null</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item 项 可以使多个 不能为null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hdel</span><span class="params">(String key, Object... item)</span> &#123;</span><br><span class="line">        redisTemplate.opsForHash().delete(key, item);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断hash表中是否有该项的值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  键 不能为null</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item 项 不能为null</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true 存在 false不存在</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hHasKey</span><span class="params">(String key, String item)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().hasKey(key, item);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * hash递增 如果不存在,就会创建一个 并把新增后的值返回</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item 项</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> by   要增加几(大于0)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">hincr</span><span class="params">(String key, String item, <span class="type">double</span> by)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().increment(key, item, by);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * hash递减</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item 项</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> by   要减少记(小于0)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">hdecr</span><span class="params">(String key, String item, <span class="type">double</span> by)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().increment(key, item, -by);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ============================set=============================</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据key获取Set中的所有值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;Object&gt; <span class="title function_">sGet</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().members(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据value从一个set中查询,是否存在</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true 存在 false不存在</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">sHasKey</span><span class="params">(String key, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().isMember(key, value);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将数据放入set缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key    键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values 值 可以是多个</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 成功个数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">sSet</span><span class="params">(String key, Object... values)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().add(key, values);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将set数据放入缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key    键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time   时间(秒)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values 值 可以是多个</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 成功个数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">sSetAndTime</span><span class="params">(String key, <span class="type">long</span> time, Object... values)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Long</span> <span class="variable">count</span> <span class="operator">=</span> redisTemplate.opsForSet().add(key, values);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>)</span><br><span class="line">                expire(key, time);</span><br><span class="line">            <span class="keyword">return</span> count;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取set缓存的长度</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">sGetSetSize</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().size(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 移除值为value的</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key    键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values 值 可以是多个</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 移除的个数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">setRemove</span><span class="params">(String key, Object... values)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Long</span> <span class="variable">count</span> <span class="operator">=</span> redisTemplate.opsForSet().remove(key, values);</span><br><span class="line">            <span class="keyword">return</span> count;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ===============================list=================================</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取list缓存的内容</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start 开始</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end   结束 0 到 -1代表所有值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Object&gt; <span class="title function_">lGet</span><span class="params">(String key, <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForList().range(key, start, end);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取list缓存的长度</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">lGetListSize</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForList().size(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过索引 获取list中的值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index 索引 index&gt;=0时， 0 表头，1 第二个元素，依次类推；index&lt;0时，-1，表尾，-2倒数第二个元素，依次类推</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">lGetIndex</span><span class="params">(String key, <span class="type">long</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForList().index(key, index);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将list放入缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">lSet</span><span class="params">(String key, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPush(key, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将list放入缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  时间(秒)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">lSet</span><span class="params">(String key, Object value, <span class="type">long</span> time)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPush(key, value);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>)</span><br><span class="line">                expire(key, time);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将list放入缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">lSet</span><span class="params">(String key, List&lt;Object&gt; value)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将list放入缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  时间(秒)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">lSet</span><span class="params">(String key, List&lt;Object&gt; value, <span class="type">long</span> time)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>)</span><br><span class="line">                expire(key, time);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据索引修改list中的某条数据</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index 索引</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">lUpdateIndex</span><span class="params">(String key, <span class="type">long</span> index, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"> </span><br><span class="line">            redisTemplate.opsForList().set(key, index, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 移除N个值为value</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> count 移除多少个</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 移除的个数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">lRemove</span><span class="params">(String key, <span class="type">long</span> count, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Long</span> <span class="variable">remove</span> <span class="operator">=</span> redisTemplate.opsForList().remove(key, count, value);</span><br><span class="line">            <span class="keyword">return</span> remove;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="7、Redis事务锁机制"><a href="#7、Redis事务锁机制" class="headerlink" title="7、Redis事务锁机制"></a>7、Redis事务锁机制</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>Redis事务是一个单独的操作：事务中的所有命令都会被序列化、按顺序地执行，事务在执行的过程中，不会其他客户端发送来的请求命令打断</p>
<p><strong>Redis事务的主要作用就是串联多个命令防止命令插队</strong></p>
<h3 id="Multi、Exec、duscard"><a href="#Multi、Exec、duscard" class="headerlink" title="Multi、Exec、duscard"></a>Multi、Exec、duscard</h3><p>从输入Multi命令开始，输入的命令会被依次进入命令队列中，但不会被执行，直到输入Exec后，Redis会将之前的命令队列中的命令依次执行</p>
<p><strong>组队的过程中可以通过discard来放弃组队</strong></p>
<p><img src="https://img.hasdsd.cn/imgimage-20230108010357345.png" alt="image-20230108010357345"></p>
<p>在组队过程中如果有语句发生错误，那么整个队伍的语句都不可以执行，当执行的过程中有语句发生错误，那么只会有发生错误的语句不执行</p>
<h3 id="事务冲突"><a href="#事务冲突" class="headerlink" title="事务冲突"></a>事务冲突</h3><p>脏读就是最典型的事务冲突，例如：A事务访问并修改了数据，但未提交；B事务读取了A事务修改后的数据，发生了脏读。若A回滚，则B所做的一切操作都是错的。如何规避事务冲突，那么就可以用到乐观锁和悲观锁</p>
<h4 id="乐观锁"><a href="#乐观锁" class="headerlink" title="乐观锁"></a>乐观锁</h4><p><img src="https://img.hasdsd.cn/imgimage-20230108155430540.png" alt="image-20230108155430540"></p>
<p>乐观锁（Optimistic Lock） ,顾名思义，就很乐观，每次去拿数据的时候都会认为别人不会修改，所以不会上锁，但是在下一次更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用版本号等机制，乐观锁适用于多读写的应用类型，这样可以提高吞吐量，Redis就是利用这种check-and-set机制实现事务</p>
<h4 id="悲观锁"><a href="#悲观锁" class="headerlink" title="悲观锁"></a>悲观锁</h4><p><img src="https://img.hasdsd.cn/imgimage-20230108154731365.png" alt="image-20230108154731365"></p>
<p> 悲观锁（pessimistic  Lock） ，顾名思义，就是很悲观，每次去拿数据的时候都认为别人会修改，所以每次拿数据的时候都会先上锁，这样别人想拿这个数据就会被阻塞（block），直到他拿到锁，传统的关系型数据库就是用道理喝多这种锁的机制，比如行锁，表锁等，读锁，写锁等都是在这个到做之前先上锁</p>
<h4 id="乐观锁在Redis中的实现"><a href="#乐观锁在Redis中的实现" class="headerlink" title="乐观锁在Redis中的实现"></a>乐观锁在Redis中的实现</h4><p>watch	key1 [key2]</p>
<p>在执行multi之前，限制性watch key1 [key2]，可以监视一个或多个key,如果在事务执行之前这个（这些）key被其他命令改动那么事务将会被打断</p>
<p><img src="https://img.hasdsd.cn/imgimage-20230108161954038.png" alt="image-20230108161954038"></p>
<p>左边先执行改动了 balance的值，而右边也进行了改动，但发现balance在 watch之后被改动过，所以不执行该事务</p>
<h3 id="Redis事务的三大特性"><a href="#Redis事务的三大特性" class="headerlink" title="Redis事务的三大特性"></a>Redis事务的三大特性</h3><ul>
<li>单独的隔离操作<ul>
<li>事务中的所有命令都会被序列化、按顺序地执行，食物在执行的过程中不会被其他客户端发来的命令请求所打断</li>
</ul>
</li>
<li>没有隔离级别的概念<ul>
<li>队列中的命令没有提交之前都不会实际被执行，因为事务提交前任何指令都不会被世纪执行</li>
</ul>
</li>
<li>不保证原子性<ul>
<li>十五中如果有一条命令执行失败，其后的命令仍然会被执行，没有回滚</li>
</ul>
</li>
</ul>
<h2 id="8、redis持久化操作"><a href="#8、redis持久化操作" class="headerlink" title="8、redis持久化操作"></a>8、redis持久化操作</h2><p>​	</p>
<p>Redis提供了两种持久化操作方式：</p>
<ul>
<li>RDB（Redis database）</li>
<li>AOF (Append of File)</li>
</ul>
<h3 id="RDB"><a href="#RDB" class="headerlink" title="RDB"></a>RDB</h3><h4 id="什么是RDB？"><a href="#什么是RDB？" class="headerlink" title="什么是RDB？"></a>什么是RDB？</h4><p>在指定的时间间隔内将内存中的数据集快照写到磁盘中，也就是行话所讲的SnapShot快照，它恢复时是将快照文件直接读到内存里</p>
<h4 id="RDB备份是怎么执行的"><a href="#RDB备份是怎么执行的" class="headerlink" title="RDB备份是怎么执行的"></a>RDB备份是怎么执行的</h4><p>Redis会单独创建（fork）一个子进程来进行持久化，会先将数据写到一个临时文件中，待持久化过程都结束了。再将这个临时文件替换上持久化好的文件。整个过程中，主进程时不进行任何IO操作的，这就确保了极高的性能，如果需要进行大规模的数据恢复，且对于数据恢复的完整性不是特别敏感，那么RDB方式是要比AOF方式更加高效，RDB的缺点是最后一次持久化的数据可能丢失</p>
<h4 id="Fork"><a href="#Fork" class="headerlink" title="Fork"></a>Fork</h4><ul>
<li>Fork的作用是复制一个与当前进程一样的进程，新进程的所有数据（变量、环境变量、程序计数器等）数值和原进程一致，但是是一个全新的进程，并作为原进程的子进程</li>
<li>在Linux系统中，fork（）会产生一个和父进程完全相同的子进程，但子进程再次后多会exec系统调用，处于效率的考虑，Linux中引用了<strong>写时复制技术</strong></li>
<li>一般情况父进程和子进程会共用一段物理内存，只有进程空间的隔断的内容要发生变化时，才会将父进程的内容复制一份给子进程</li>
</ul>
<p>利用配置文件管理save</p>
<ul>
<li><p>save 900 1 表示在 900 秒内，至少更新了 1 条数据，Redis 自动触发 BGSAVE 命令，将数据保存到硬盘。</p>
</li>
<li><p>save 300 10 表示在 300 秒内，至少更新了 10 条数据，Redis 自动触 BGSAVE 命令，将数据保存到硬盘</p>
</li>
<li><p>save 60 10000 表示 60 秒内，至少更新了 10000 条数据，Redis 自动触发 BGSAVE 命令，将数据保存到硬盘。</p>
</li>
<li><p><img src="https://img.hasdsd.cn/imgimage-20230111152835505.png" alt="image-20230111152835505"></p>
</li>
</ul>
<p>我们知道，在 RDB 持久化的过程中，子进程会把 Redis 的所有数据都保存到新建的 dump.rdb 文件中，这是一个既消耗资源又浪费时间的操作。因此 Redis 服务器不能过于频繁地创建 rdb 文件，否则会严重影响服务器的性能。</p>
<p>RDB 持久化的最大不足之处在于，最后一次持久化的数据可能会出现丢失的情况。我们可以这样理解，在 持久化进行过程中，服务器突然宕机了，这时存储的数据可能并不完整，比如子进程已经生成了 rdb 文件，但是主进程还没来得及用它覆盖掉原来的旧 rdb 文件，这样就把最后一次持久化的数据丢失了。</p>
<p>RDB 数据持久化适合于大规模的数据恢复，并且还原速度快，如果对数据的完整性不是特别敏感（可能存在最后一次丢失的情况），那么 RDB 持久化方式非常合适。</p>
<p>自动触发RDB持久化操作</p>
<p>当我们对redis的操作达到了配置文件中的条件，那么就会生成dump文件在我们所指定的目录中（配置文件中可以指定dump文件的位置和名称）,当我们的redis 突然宕机，那么当我们重启redis服务时，redis会帮我们将原来的数据恢复</p>
<p>手动触发RDB持久化操作</p>
<p><strong>save</strong>  、<strong>bgsave</strong>(默认)</p>
<p>save:生产上，是绝对不可以用save的，因为save为一个阻塞命令，当执行时redis会放下手头的工作全力以赴的去生成dump文件，在生产中，每秒产生数以万计的缓存，如果发生阻塞，那么缓存中的信息会直接消失</p>
<p>bgsave:Redis会在后台异步进行快照操作，不阻塞快照同时还可以响应客户端请求,该触发方式会fork一个子进程由子进程复制持久化过程</p>
<p><strong>lastsave</strong>: 上一次执行快照的时间</p>
<p>原理如下</p>
<h4 id="RDB快照模式原理"><a href="#RDB快照模式原理" class="headerlink" title="RDB快照模式原理"></a>RDB快照模式原理</h4><p>RDB 即快照模式，它是 Redis 默认的数据持久化方式，它会将数据库的快照保存在 dump.rdb 这个二进制文件中。</p>
<p>提示：所谓“快照”就是将内存数据以二进制文件的形式保存起来。</p>
<p>我们知道 Redis 是单线程的，也就说一个线程要同时负责多个客户端套接字的并发读写，以及内存数据结构的逻辑读写。</p>
<p>Redis 服务器不仅需要服务线上请求，同时还要备份内存快照。在备份过程中 Redis 必须进行文件 IO 读写，而 IO 操作会严重服务器的性能。那么如何实现既不影响客户端的请求，又实现快照备份操作呢，这时就用到了多进程。</p>
<p>Redis 使用操作系统的多进程 COW(Copy On Write) 机制来实现快照持久化操作。</p>
<p>RDB 实际上是 Redis 内部的一个定时器事件，它每隔一段固定时间就去检查当前数据发生改变的次数和改变的时间频率，看它们是否满足配置文件中规定的持久化触发条件。当满足条件时，Redis 就会通过操作系统调用 fork() 来创建一个子进程，该子进程与父进程享有相同的地址空间。</p>
<p>Redis 通过子进程遍历整个内存空间来获取存储的数据，从而完成数据持久化操作。注意，此时的主进程则仍然可以对外提供服务，父子进程之间通过操作系统的 COW 机制实现了数据段分离，从而保证了父子进程之间互不影响。</p>
<h4 id="RDB文件修复"><a href="#RDB文件修复" class="headerlink" title="RDB文件修复"></a>RDB文件修复</h4><p>当出现rdb文件中出现缺失的信息该怎么办</p>
<p>例如：我们的rdb文件中写着1k条数据，当我下次正在写入rdb文件时 突然redis宕机了，rdb文件中传入了残次的数据，导致rdb文件无法运行数据无法恢复这时该怎么办</p>
<p>在我们的   redis-server 与 redis- cli的同级文件下有这样的一个方法 redis-check-rdb 他可以检查指定rdb文件的完整性与正确性</p>
<h4 id="触发RDB快照模式的条件"><a href="#触发RDB快照模式的条件" class="headerlink" title="触发RDB快照模式的条件"></a>触发RDB快照模式的条件</h4><ol>
<li>配置文件中默认的快照配置</li>
<li>手动save&#x2F;bgsave命令</li>
<li>执行flushall&#x2F;flushdb命令也会产生dump.rdb文件</li>
<li>执行shutdown且没有设置开启AOF持久化</li>
<li>主从复制时，主节点的自动触发</li>
</ol>
<h4 id="redis快照模式调优参数"><a href="#redis快照模式调优参数" class="headerlink" title="redis快照模式调优参数"></a>redis快照模式调优参数</h4><p>stop-srites-on-bgsave-error: 是否在bgsave操作出错时停止写入操作</p>
<p>默认yes<br>如果配置成no，表示你不在乎数据不一致或者有其他的手段发现和控制这种不一致，那么在快照写入失败时也能确保redis继续接受新的写请求</p>
<p>rdbcomporession:对于存储到磁盘中的快照，可以设置是否进行压缩存储，默认为yes，redis会采用LZF算法进行压缩，如果不想消耗CPU来进行压缩的话，可以设置关闭此功能</p>
<p>rdbchecksum </p>
<p>在存储快照后，还可以让redis使用CRC64算法来进行数据校验，但是这样做会增加大约10%的性能消耗，如果希望得到性能提升可以关闭此功能</p>
<p>rdb-del-sync-files :在没有持久性的情况下删除复制中使用的RDB文件启用。默认情况下no，此选禁用的</p>
<h3 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h3><h4 id="什么是AOF？"><a href="#什么是AOF？" class="headerlink" title="什么是AOF？"></a>什么是AOF？</h4><p>以日志的形式来记录每个写操作（增量保存），将Redis执行过程的所有写指令记录下来（读操作不记录），只追加文件但不可以修改写文件，Redis启动之初会读取该文件重新构建数据，换而言之，redis重启的话就根据日志文件的内容将写指令从前到后执行一次以完成数据的回复操作</p>
<h4 id="AOF的持久化流程"><a href="#AOF的持久化流程" class="headerlink" title="AOF的持久化流程"></a>AOF的持久化流程</h4><ol>
<li>客户端的请求写命令会被append追加到 AOF缓冲区内</li>
<li>AOF缓冲区根据AOF持久化策略（always，everysec，no）将操作sync同步到磁盘的AOF文件中</li>
<li>AOF文件大小超过重写策略或手动重写时，会对AOF文件rewrite’重写，压缩AOF文件容量</li>
<li>Redis服务重启时，会重新load加载AOF文件中的写操作达到数据恢复的目的</li>
</ol>
<p><img src="https://img.hasdsd.cn/imgimage-20230517170420924.png" alt="image-20230517170420924"></p>
<h4 id="异常恢复"><a href="#异常恢复" class="headerlink" title="异常恢复"></a>异常恢复</h4><p>如果AOF文件遇到损坏，通过 &#x2F;usr&#x2F;local&#x2F;bin&#x2F;redis-check-aof   –fix   appendonly.aof的相对路径  进行修复，修复后重启redis</p>
<h4 id="AOF同步频率配置"><a href="#AOF同步频率配置" class="headerlink" title="AOF同步频率配置"></a>AOF同步频率配置</h4><p>appendfsync  always    始终同步，每次Redis的写入都会立即写入日志；性能较差但数据完整性比较好</p>
<p>appendfsync  everysec  每秒同步，每秒计入日志一次，如果宕机，本秒的数据可能会丢失</p>
<p>appendfsync no   redis不主动进行同步，把同步时机交给操作系统</p>
<h4 id="AOF的文件存储规则与命名规则"><a href="#AOF的文件存储规则与命名规则" class="headerlink" title="AOF的文件存储规则与命名规则"></a>AOF的文件存储规则与命名规则</h4><p>reids7中 AOF目录默认存储来dump文件下，其中含有AOF文件，同时AOF引入了MP AOF原先单个的AOF文件变成了多个</p>
<p>顾名思义，Multi-Part-AOF就是将原来的单个AOF文件拆分成多个AOF文件。在MP-AOF中，我们将AOF分为三种类型，</p>
<p>分别为：</p>
<ul>
<li>BASE：基础的AOF，一般由子进程重写完成，改文件最多有有一个</li>
<li>INCR：表示增量AOF，一般在AOFRW时被构建一般有多个</li>
<li>HISTORY：表示历史AOF，它由BASE与INCR AOF变化而来，每次AOFRW成功完成时，本次AOFRW之前对应的BASE与INCR AOF将会变为HISTORY，HISTORY类型的AOF也会被redis自动删除</li>
<li>为了管理这些AOF文件，我们因付了一个manifest（清单）文件来追踪，管理这些AOF。同时，为了便于AOF备份和靠背，我们将所有的AOF文件和mainfest文件放在一个独立的文件夹目录中，目录由appenddirname配置决定</li>
</ul>
<h4 id="Rewrite压缩"><a href="#Rewrite压缩" class="headerlink" title="Rewrite压缩"></a>Rewrite压缩</h4><h5 id="什么是rewrite"><a href="#什么是rewrite" class="headerlink" title="什么是rewrite"></a>什么是rewrite</h5><p>AOF采用文件追加的方式，文件会越来越大，为了避免出现此种情况，新增了重写机制，当AOF文件的大小超过所设定的阈值时，Redis就会启动AOF文件的内容压缩，只保留可以恢复数据的最小指令集，可以使用命令bgrewriteaof</p>
<h5 id="重写原理，如何实现重写"><a href="#重写原理，如何实现重写" class="headerlink" title="重写原理，如何实现重写"></a>重写原理，如何实现重写</h5><p>AOF文件持续增长而过大时，会fork出一条新进程来将文件重写（也是先写临时文件最后再rename），redis4.0后的重写，是指就是吧RDB的快照以2进制的形式附在新的aof头部，作为已有历史数据替换掉原来的流水账操作，我们可以设置一个基准，当文件大小大于这个基准的一倍时则会实现重写操作</p>
<h5 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h5><ul>
<li>备份机制更加稳健，丢失数据概率更低</li>
<li>可读的日志文本，通过操作AOF文件，可以处理误操作</li>
</ul>
<h5 id="劣势"><a href="#劣势" class="headerlink" title="劣势"></a>劣势</h5><ul>
<li>比起RDB占用更多的磁盘空间</li>
<li>恢复备份速度更慢</li>
<li>每次读写都同步的话对性能有一定压力</li>
<li>存在个别BUG造成回复不能</li>
</ul>
<h3 id="何时用RDB何时用AOF"><a href="#何时用RDB何时用AOF" class="headerlink" title="何时用RDB何时用AOF"></a>何时用RDB何时用AOF</h3><ul>
<li>数据不敏感可单独选用RDB</li>
<li>不建议单独用AOF，会出现BUG</li>
<li>当Redis只是做缓存时可以都不用</li>
</ul>
<h2 id="9、主从复制"><a href="#9、主从复制" class="headerlink" title="9、主从复制"></a>9、主从复制</h2><h3 id="什么是主从复制"><a href="#什么是主从复制" class="headerlink" title="什么是主从复制"></a>什么是主从复制</h3><p>主机数据更新后根据配置和策略，自动同步到备机的master&#x2F;slaver机制，Master以写为主，slave以读为主 </p>
<h3 id="能干嘛"><a href="#能干嘛" class="headerlink" title="能干嘛"></a>能干嘛</h3><ul>
<li>读写分离，性能扩展</li>
<li>容灾快速恢复</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">info repliction  <span class="comment">#查看主从复制的相关信息</span></span><br></pre></td></tr></table></figure>

<h2 id="10、缓存"><a href="#10、缓存" class="headerlink" title="10、缓存"></a>10、缓存</h2><h3 id="1、什么是缓存"><a href="#1、什么是缓存" class="headerlink" title="1、什么是缓存"></a>1、什么是缓存</h3><p>缓存就是数据交换的缓冲区（cache），就是存储数据的临时地方，一般读写性能比较高</p>
<h3 id="2、缓存的作用与成本"><a href="#2、缓存的作用与成本" class="headerlink" title="2、缓存的作用与成本"></a>2、缓存的作用与成本</h3><ul>
<li>作用：降低后端负载，提高读写效率降低响应时间</li>
<li>成本：数据一致性成本，代码维护成本，运维成本</li>
</ul>
<p><img src="C:\Users\15754\AppData\Roaming\Typora\typora-user-images\image-20230131152202214.png" alt="image-20230131152202214"></p>
<ul>
<li><h4 id="缓存的使用：主动更新下的修改数据库信息后再删除缓存内容"><a href="#缓存的使用：主动更新下的修改数据库信息后再删除缓存内容" class="headerlink" title="缓存的使用：主动更新下的修改数据库信息后再删除缓存内容"></a>缓存的使用：主动更新下的修改数据库信息后再删除缓存内容</h4></li>
</ul>
<h3 id="3、缓存穿透"><a href="#3、缓存穿透" class="headerlink" title="3、缓存穿透"></a>3、缓存穿透</h3><p>缓存穿透是指客户端请求的数据在缓存中和数据库中都不存在，这样缓存永远不会生效，这些请求都会达到数据库</p>
<p>常见的解决方案：</p>
<ul>
<li><h4 id="缓存空对象"><a href="#缓存空对象" class="headerlink" title="缓存空对象"></a>缓存空对象</h4><ul>
<li>优点：实现简单，维护方便</li>
<li>缺点<ul>
<li>额外的内存消耗</li>
<li>可能造成短期的不一致<img src="C:\Users\15754\AppData\Roaming\Typora\typora-user-images\image-20230131162849236.png" alt="image-20230131162849236"></li>
</ul>
</li>
</ul>
</li>
<li><h4 id="布隆过滤"><a href="#布隆过滤" class="headerlink" title="布隆过滤"></a>布隆过滤</h4><ul>
<li>优点：内存占用较少，没有多余的key</li>
<li>缺点：<ul>
<li>实现复杂</li>
<li>存在误判的可能</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="C:\Users\15754\AppData\Roaming\Typora\typora-user-images\image-20230131163449717.png" alt="image-20230131163449717"></p>
<h3 id="4、缓存雪崩"><a href="#4、缓存雪崩" class="headerlink" title="4、缓存雪崩"></a>4、缓存雪崩</h3><p>缓存雪崩是指同一时段大量的缓存key同时失效或redis服务宕机，导致大量请求到达数据库，带来巨大压力</p>
<p>解决方案：</p>
<ul>
<li>给不同的key的TTL添加随机值</li>
<li>利用Redis集群提高服务的可用性</li>
<li>给缓存业务添加降级限流策略</li>
<li>给业务添加多级缓存</li>
</ul>
<h3 id="5、缓存击穿"><a href="#5、缓存击穿" class="headerlink" title="5、缓存击穿"></a>5、缓存击穿</h3><p>​	缓存击穿问题也叫做热点key问题，就是一个被高并发访问并且缓存重建业务较复杂的key突然失效了，无数的请求访问会在瞬间给数据库带来巨大的冲击</p>
<p>解决方案：</p>
<ul>
<li><p>互斥锁</p>
</li>
<li><p>逻辑过期</p>
</li>
</ul>
<p><img src="C:\Users\15754\AppData\Roaming\Typora\typora-user-images\image-20230131174445701.png" alt="image-20230131174445701"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">学不动学不懂学步冻</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/12/15/Redis/">http://example.com/2022/12/15/Redis/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">MyBlog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://img.hasdsd.cn/imgredis.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/01/05/Linux/" title="Linux"><img class="cover" src="https://img.hasdsd.cn/imgLinux.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Linux</div></div></a></div><div class="next-post pull-right"><a href="/2022/11/05/SpringBoot/" title="SpringBoot"><img class="cover" src="https://img.hasdsd.cn/imgQQ截图20230307190709.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">SpringBoot</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/118332734?v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">学不动学不懂学步冻</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zzzzzf2001"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/zzzzzf2001" target="_blank" title=""><i class="fab fa-github"></i></a><a class="social-icon" href="/zzzzzf011129@163.com" target="_blank" title=""><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">我们该怎样道别呢？向我们当初见面那样？</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis"><span class="toc-number">1.</span> <span class="toc-text">Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81NoSQL"><span class="toc-number">1.1.</span> <span class="toc-text">1、NoSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.1.</span> <span class="toc-text">1、概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81NoSQL-%E5%B8%B8%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.1.2.</span> <span class="toc-text">2、NoSQL 常用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81NoSQL%E4%B8%8D%E6%94%AF%E6%8C%81%E7%9A%84%E5%9C%BA%E6%99%AF"><span class="toc-number">1.1.3.</span> <span class="toc-text">3、NoSQL不支持的场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%AE%89%E8%A3%85Redis"><span class="toc-number">1.1.4.</span> <span class="toc-text">4、安装Redis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81Redis%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.</span> <span class="toc-text">2、Redis的数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis%E5%AF%B9%E9%94%AE%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">1.2.1.</span> <span class="toc-text">Redis对键的操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%88String%EF%BC%89"><span class="toc-number">1.2.2.</span> <span class="toc-text">Redis字符串（String）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">常用命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#String%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">String类型的应用场景</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis%E5%88%97%E8%A1%A8%EF%BC%88List%EF%BC%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">Redis列表（List）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">常见命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis%E9%9B%86%E5%90%88Set"><span class="toc-number">1.2.4.</span> <span class="toc-text">Redis集合Set</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis-%E5%93%88%E5%B8%8C%EF%BC%88Hash%EF%BC%89"><span class="toc-number">1.2.5.</span> <span class="toc-text">Redis 哈希（Hash）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-2"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">常用的命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88Zset%EF%BC%88sorted-set%EF%BC%89"><span class="toc-number">1.2.6.</span> <span class="toc-text">Redis有序集合Zset（sorted set）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%B3%E8%B7%83%E8%A1%A8"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">跳跃表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81Redis%E4%B8%AD%E7%9A%84%E5%8F%91%E5%B8%83%E4%B8%8E%E8%AE%A2%E9%98%85"><span class="toc-number">1.3.</span> <span class="toc-text">3、Redis中的发布与订阅</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.3.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.2.</span> <span class="toc-text">发布订阅命令行实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81Redis7%E6%96%B0%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.4.</span> <span class="toc-text">4、Redis7新数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#redis-%E4%BD%8D%E5%9F%9F-bitfield"><span class="toc-number">1.4.1.</span> <span class="toc-text">redis 位域(bitfield)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redis%E6%B5%81%EF%BC%88stream%EF%BC%89"><span class="toc-number">1.4.2.</span> <span class="toc-text">redis流（stream）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bitmaps%EF%BC%88%E4%BD%8D%E5%9B%BE%EF%BC%89"><span class="toc-number">1.4.3.</span> <span class="toc-text">bitmaps（位图）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HyperLogLog"><span class="toc-number">1.4.4.</span> <span class="toc-text">HyperLogLog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Geospatial"><span class="toc-number">1.4.5.</span> <span class="toc-text">Geospatial</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81jedis"><span class="toc-number">1.5.</span> <span class="toc-text">5、jedis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringDataRedis"><span class="toc-number">1.6.</span> <span class="toc-text">SpringDataRedis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SpringDataRedis%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">1.6.1.</span> <span class="toc-text">SpringDataRedis快速入门</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8SpringDataRedis"><span class="toc-number">1.6.2.</span> <span class="toc-text">使用SpringDataRedis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81Springboot%E6%95%B4%E5%90%88redis"><span class="toc-number">1.7.</span> <span class="toc-text">6、Springboot整合redis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81Redis%E4%BA%8B%E5%8A%A1%E9%94%81%E6%9C%BA%E5%88%B6"><span class="toc-number">1.8.</span> <span class="toc-text">7、Redis事务锁机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-number">1.8.1.</span> <span class="toc-text">定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Multi%E3%80%81Exec%E3%80%81duscard"><span class="toc-number">1.8.2.</span> <span class="toc-text">Multi、Exec、duscard</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%86%B2%E7%AA%81"><span class="toc-number">1.8.3.</span> <span class="toc-text">事务冲突</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B9%90%E8%A7%82%E9%94%81"><span class="toc-number">1.8.3.1.</span> <span class="toc-text">乐观锁</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%82%B2%E8%A7%82%E9%94%81"><span class="toc-number">1.8.3.2.</span> <span class="toc-text">悲观锁</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B9%90%E8%A7%82%E9%94%81%E5%9C%A8Redis%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.8.3.3.</span> <span class="toc-text">乐观锁在Redis中的实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%B8%89%E5%A4%A7%E7%89%B9%E6%80%A7"><span class="toc-number">1.8.4.</span> <span class="toc-text">Redis事务的三大特性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%93%8D%E4%BD%9C"><span class="toc-number">1.9.</span> <span class="toc-text">8、redis持久化操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RDB"><span class="toc-number">1.9.1.</span> <span class="toc-text">RDB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFRDB%EF%BC%9F"><span class="toc-number">1.9.1.1.</span> <span class="toc-text">什么是RDB？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RDB%E5%A4%87%E4%BB%BD%E6%98%AF%E6%80%8E%E4%B9%88%E6%89%A7%E8%A1%8C%E7%9A%84"><span class="toc-number">1.9.1.2.</span> <span class="toc-text">RDB备份是怎么执行的</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fork"><span class="toc-number">1.9.1.3.</span> <span class="toc-text">Fork</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RDB%E5%BF%AB%E7%85%A7%E6%A8%A1%E5%BC%8F%E5%8E%9F%E7%90%86"><span class="toc-number">1.9.1.4.</span> <span class="toc-text">RDB快照模式原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RDB%E6%96%87%E4%BB%B6%E4%BF%AE%E5%A4%8D"><span class="toc-number">1.9.1.5.</span> <span class="toc-text">RDB文件修复</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91RDB%E5%BF%AB%E7%85%A7%E6%A8%A1%E5%BC%8F%E7%9A%84%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.9.1.6.</span> <span class="toc-text">触发RDB快照模式的条件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#redis%E5%BF%AB%E7%85%A7%E6%A8%A1%E5%BC%8F%E8%B0%83%E4%BC%98%E5%8F%82%E6%95%B0"><span class="toc-number">1.9.1.7.</span> <span class="toc-text">redis快照模式调优参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AOF"><span class="toc-number">1.9.2.</span> <span class="toc-text">AOF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFAOF%EF%BC%9F"><span class="toc-number">1.9.2.1.</span> <span class="toc-text">什么是AOF？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AOF%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96%E6%B5%81%E7%A8%8B"><span class="toc-number">1.9.2.2.</span> <span class="toc-text">AOF的持久化流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E6%81%A2%E5%A4%8D"><span class="toc-number">1.9.2.3.</span> <span class="toc-text">异常恢复</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AOF%E5%90%8C%E6%AD%A5%E9%A2%91%E7%8E%87%E9%85%8D%E7%BD%AE"><span class="toc-number">1.9.2.4.</span> <span class="toc-text">AOF同步频率配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AOF%E7%9A%84%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8%E8%A7%84%E5%88%99%E4%B8%8E%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99"><span class="toc-number">1.9.2.5.</span> <span class="toc-text">AOF的文件存储规则与命名规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Rewrite%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.9.2.6.</span> <span class="toc-text">Rewrite压缩</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFrewrite"><span class="toc-number">1.9.2.6.1.</span> <span class="toc-text">什么是rewrite</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%87%8D%E5%86%99%E5%8E%9F%E7%90%86%EF%BC%8C%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E9%87%8D%E5%86%99"><span class="toc-number">1.9.2.6.2.</span> <span class="toc-text">重写原理，如何实现重写</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%98%E5%8A%BF"><span class="toc-number">1.9.2.6.3.</span> <span class="toc-text">优势</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A3%E5%8A%BF"><span class="toc-number">1.9.2.6.4.</span> <span class="toc-text">劣势</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%95%E6%97%B6%E7%94%A8RDB%E4%BD%95%E6%97%B6%E7%94%A8AOF"><span class="toc-number">1.9.3.</span> <span class="toc-text">何时用RDB何时用AOF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9%E3%80%81%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-number">1.10.</span> <span class="toc-text">9、主从复制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-number">1.10.1.</span> <span class="toc-text">什么是主从复制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%83%BD%E5%B9%B2%E5%98%9B"><span class="toc-number">1.10.2.</span> <span class="toc-text">能干嘛</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10%E3%80%81%E7%BC%93%E5%AD%98"><span class="toc-number">1.11.</span> <span class="toc-text">10、缓存</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E7%BC%93%E5%AD%98"><span class="toc-number">1.11.1.</span> <span class="toc-text">1、什么是缓存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E7%BC%93%E5%AD%98%E7%9A%84%E4%BD%9C%E7%94%A8%E4%B8%8E%E6%88%90%E6%9C%AC"><span class="toc-number">1.11.2.</span> <span class="toc-text">2、缓存的作用与成本</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%9A%E4%B8%BB%E5%8A%A8%E6%9B%B4%E6%96%B0%E4%B8%8B%E7%9A%84%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E5%90%8E%E5%86%8D%E5%88%A0%E9%99%A4%E7%BC%93%E5%AD%98%E5%86%85%E5%AE%B9"><span class="toc-number">1.11.2.1.</span> <span class="toc-text">缓存的使用：主动更新下的修改数据库信息后再删除缓存内容</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F"><span class="toc-number">1.11.3.</span> <span class="toc-text">3、缓存穿透</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E7%A9%BA%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.11.3.1.</span> <span class="toc-text">缓存空对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4"><span class="toc-number">1.11.3.2.</span> <span class="toc-text">布隆过滤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9"><span class="toc-number">1.11.4.</span> <span class="toc-text">4、缓存雪崩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF"><span class="toc-number">1.11.5.</span> <span class="toc-text">5、缓存击穿</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/05/24/%E5%88%A9%E7%94%A8%E9%98%BF%E9%87%8C%E4%BA%91OSS%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E6%B5%81%E4%BC%A0%E8%BE%93/" title="利用阿里云OSS实现文件流传输"><img src="https://img.hasdsd.cn/imgOIP-C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="利用阿里云OSS实现文件流传输"/></a><div class="content"><a class="title" href="/2023/05/24/%E5%88%A9%E7%94%A8%E9%98%BF%E9%87%8C%E4%BA%91OSS%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E6%B5%81%E4%BC%A0%E8%BE%93/" title="利用阿里云OSS实现文件流传输">利用阿里云OSS实现文件流传输</a><time datetime="2023-05-23T16:00:00.000Z" title="发表于 2023-05-24 00:00:00">2023-05-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/03/JWT/" title="JWT"><img src="https://img.hasdsd.cn/imgjwt.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JWT"/></a><div class="content"><a class="title" href="/2023/05/03/JWT/" title="JWT">JWT</a><time datetime="2023-05-02T16:00:00.000Z" title="发表于 2023-05-03 00:00:00">2023-05-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/04/26/2023-4-17-mysql%E9%94%81/" title="mysql锁"><img src="https://img.hasdsd.cn/img锁.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="mysql锁"/></a><div class="content"><a class="title" href="/2023/04/26/2023-4-17-mysql%E9%94%81/" title="mysql锁">mysql锁</a><time datetime="2023-04-25T16:00:00.000Z" title="发表于 2023-04-26 00:00:00">2023-04-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/04/25/TypeScript/" title="TypeScript"><img src="https://img.hasdsd.cn/imgTypeScriptImage.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="TypeScript"/></a><div class="content"><a class="title" href="/2023/04/25/TypeScript/" title="TypeScript">TypeScript</a><time datetime="2023-04-24T16:00:00.000Z" title="发表于 2023-04-25 00:00:00">2023-04-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/04/25/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" title="微信小程序"><img src="https://img.hasdsd.cn/img小程序.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="微信小程序"/></a><div class="content"><a class="title" href="/2023/04/25/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" title="微信小程序">微信小程序</a><time datetime="2023-04-24T16:00:00.000Z" title="发表于 2023-04-25 00:00:00">2023-04-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 学不动学不懂学步冻</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>